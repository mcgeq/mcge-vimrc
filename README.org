#+TITLE: Vim Config
#+AUTHOR: mcge
#+DATE: <2024-03-27 19:38:19>
* A simple vim configuration
此 vimrc 配置是使用 vim9script 编写。
** 配置 vimrc
在=vimrc=文件中写入以下内容
#+BEGIN_SRC vimscript
  vim9script
  # 自定义vim配置文件路径
  g:mcge_customvimrcdir = "D:/config/mcge-vimrc"
  var runtimepath_exist = index(split(&runtimepath, ','), g:mcge_customvimrcdir) != -1
  if !runtimepath_exist
      # 将自定义的配置文件路径加入`runtimepath'
      execute 'set runtimepath+=' .. g:mcge_customvimrcdir
  endif
  # 判断自定义的配置文件路径是否已经存在packpath中使用vim内置包管理自动加载
  var packpath_exist = index(split(&packpath, ','), g:mcge_customvimrcdir) != -1
  if !packpath_exist
      execute 'set packpath+=' .. g:mcge_customvimrcdir
  endif
  # 加载配置文件
  execute 'source ' .. fnameescape(g:mcge_customvimrcdir .. '/init.vim')
#+END_SRC

** 废弃的方法
#+BEGIN_SRC vimscript
# 获取指定字符串结尾目录的下一级目录
def GetSubDirectories(path: string, suffix: string, next: bool): list<string> 
    var subdirectories = []
    def RecursiveTraversal(directory: string)
	for entry in glob(directory .. '/*', 1, 1)
		if isdirectory(entry)
			if fnamemodify(entry, ':t') ==# suffix
				if next
					for sub_entry in glob(entry .. '/*', 1, 1)
						if isdirectory(sub_entry)
                			add(subdirectories, sub_entry)
						endif
					endfor
				else
					add(subdirectories, entry)
				endif
			endif
			call RecursiveTraversal(entry)
		endif
	endfor
    enddef
    call RecursiveTraversal(path)
    return subdirectories
enddef


var subdires = GetSubDirectories(g:mcge_customvimrcdir, 'start', true)
# for directory in subdires
#	execute 'set runtimepath+=' .. directory
#	var docdir = directory .. "\\doc"
#	if isdirectory(docdir)
#		execute "helptags " .. docdir
#	endif
# endfor
var optdires = GetSubDirectories(g:mcge_customvimrcdir, 'opt', false)
# for dires in optdires
#	execute 'set runtimepath+=' .. dires
# endfor
#+END_SRC

** 配置文件目录介绍
- colors :: 自定义 colorscheme
- pack :: 插件，使用 vim 内置的包管理功能
- config :: 存放具体配置的目录
  + core :: 全局变量等
- ftdetect :: 设置文件类型检测
- ftplugin :: 针对文件类型加载的插件
